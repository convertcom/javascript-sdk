/*!
 * Convert JS SDK
 * Version 1.0.0
 * Copyright(c) 2020-2022 Convert Insights, Inc
 * License Apache-2.0
 */
"use strict";var e=require("murmurhash"),t=require("@convertcom/utils"),r=require("@convertcom/enums");exports.BucketingManager=class{constructor(e,{loggerManager:i}={}){var a,s;this._max_traffic=1e4,this._hash_seed=9999,this._loggerManager=i,this._max_traffic=t.objectDeepValue(e,"bucketing.max_traffic",1e4,!0),this._hash_seed=t.objectDeepValue(e,"bucketing.hash_seed",9999,!0),null===(s=null===(a=this._loggerManager)||void 0===a?void 0:a.trace)||void 0===s||s.call(a,r.MESSAGES.BUCKETING_CONSTRUCTOR,this)}selectBucket(e,t,r=0){var i,a;let s=null,l=0;return Object.keys(e).some((i=>(l+=100*e[i]+r,t<l&&(s=i,!0)))),null===(a=null===(i=this._loggerManager)||void 0===i?void 0:i.debug)||void 0===a||a.call(i,"BucketingManager.selectBucket()",{buckets:e,value:t,redistribute:r},{variation:s}),s||null}getValueVisitorBased(t,r=this._hash_seed){var i,a;const s=e.v3(String(t),r)/4294967296*this._max_traffic,l=parseInt(String(s),10);return null===(a=null===(i=this._loggerManager)||void 0===i?void 0:i.debug)||void 0===a||a.call(i,"BucketingManager.getValueVisitorBased()",{visitorId:t,seed:r,val:s,result:l}),l}getBucketForVisitor(e,t,r=0,i){const a=this.getValueVisitorBased(t,i);return this.selectBucket(e,a,r)}};
//# sourceMappingURL=index.min.js.map
